getwd()
source("00_Summary_EDITME.R")
global_path
rdir <-paste(global_path,"/Dat_WB_OASIM/originals/",sep="")
nx <- as.double(400) # first lambda
ny <- as.double(700) # last lambda
ano1 <- as.character(as.double(2006)) # first year
ano2 <- as.character(as.double(2008)) # last year
sdir <-paste(global_path,"/Dat_WB_OASIM/binary/",sep="")
################################
###  Chla and PPC concentrations
################################
# Input: .csv tables of hplc samples, quality controlled (FLAG3 and FLAG5)
# Output:  grids with 2x2 degrees and model depth layers
p_dir<-paste(global_path,"/Dat_observations/HPLC/",sep="")
# one for MAREDAT: "pigments_MAREDAT_and_Claustre_quality_controled.csv"
# one for CSIRO: "TOTAL_CSIRO_hplc.csv"
# other for Bracher : "TOTAL_Astrid6_hplc.csv"
# other for Chase: "TOTAL_Chase_hplc.csv"
# combine them in ALL
# define grid in depth : use the model
experimentos<-read.csv(paste(global_path,"/Res_model/run_log_marshall_PPC_PS_SA_G100.csv",sep=""), sep=",")
modelnames<-experimentos$name[c(21,9)]
modelnames
ruta<-experimentos$path[c(21,9)]
load(paste(global_path,"/Res_model/interpolated/","1cloro_global/",modelnames[1],".RData",sep=""))
prof_field <-(-as.numeric(unlist(dimnames(res)$z)))
Zu <- prof_field-(c(10,diff(prof_field))/2)
Zl <- prof_field+(c(diff(prof_field),500)/2)
#cbind(prof_field, ((Zu+Zl)/2), Zu, Zl)
latitud  <- cbind(seq(-90,88,by=2),seq(-89,89,by=2),seq(-88,90,by=2))
longitud <- cbind(seq(-180,178,by=2),seq(-179,179,by=2),seq(-178,180,by=2))
clases_lat  <-seq(-90,90,by=2)
clases_log  <-seq(-180,180,by=2)
clases_pro  <-c(0,Zl)
clases_time <-c(0:12)
month<-c(1:12)
# Tabla datos Astrid
astrid<-read.csv(paste(p_dir,"TOTAL_Astrid6_hplc.csv", sep=""))
names(astrid)
nombres_astrid<-names(astrid)[c(3,9,16,11:13,18,19,24,28,31,37,51,54:56,53,58)]
astrid2<-astrid[,c(3,9,16,11:13,18,19,24,28,31,37,51,54:56,53,58)]
dim(astrid2)
p_dir
# Tabla datos MAREDAT
experimentos<-read.csv(paste(p_dir,"pigments_MAREDAT_and_Claustre_quality_controled.csv", sep=""))
#names(experimentos)
cruise <- experimentos$Cruise_des
lati<-experimentos$lat   # plot(long, lati)
long<-experimentos$lon
depth<-as.numeric(as.character(experimentos$Depth.m.)) # CUIDADO: lo lee como factor
YEAR  <- experimentos$Year       # range(YEAR, na.rm=TRUE)
times <- experimentos$Month
DAY <- experimentos$Day
datetime <- as.Date(paste(DAY,times,YEAR, sep="/"), format="%d/%m/%Y")
JULIAN <- julian(datetime, origin = as.Date("1988-01-01")) # range(JULIAN, na.rm=TRUE)
range(datetime[!is.na(experimentos$MTChla)],na.rm=T)
p_dir
paste(p_dir,"grids_pigments/","PPCinsitu_new3.RData", sep="")
p_dir
p_dir<-paste(global_path,"Dat_observations/HPLC/",sep="")
# one for MAREDAT: "pigments_MAREDAT_and_Claustre_quality_controled.csv"
# one for CSIRO: "TOTAL_CSIRO_hplc.csv"
# other for Bracher : "TOTAL_Astrid6_hplc.csv"
# other for Chase: "TOTAL_Chase_hplc.csv"
# combine them in ALL
paste(p_dir,"grids_pigments/","PPCinsitu_new3.RData", sep="")
paste(p_dir,"/grids_pigments/","TChla_insitu_new2.RData",sep="")
paste(global_path, "Scripts/05_Insitu_BO_Valente_Casey_Chase_CSIRO_Astrid_make_grids.R", sep="")
